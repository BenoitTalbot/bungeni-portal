
copy "public"."parliamentary_items" ( "parliamentary_item_id", "parliament_id", "owner_id",
    "language",  
    "short_name", "full_name", "body_text", "submission_date", 
    "status", "type" )
from '%(directory)s/data/demodata/parliamentary_items.csv'
csv ;   

COPY public.bills (bill_id, bill_type_id, ministry_id, identifier, summary, publication_date )
FROM '%(directory)s/data/demodata/bills.csv'
csv ; 


COPY public.questions ( question_id,  question_number, approval_date, ministry_submit_date, 
     question_type, response_type, supplement_parent_id, sitting_time, ministry_id ) 
FROM '%(directory)s/data/demodata/questions.csv'
csv ; 
      

COPY public.motions (motion_id)
from '%(directory)s/data/demodata/motions.csv'
csv ; 


UPDATE "public"."parliamentary_items" set "status" = 'draft';

/*COPY public.question_changes (change_id, content_id, action, date, description, notes, user_id)
from '%(directory)s/data/demodata/question_changes.csv'
csv ; 

copy public.bill_changes (change_id, content_id, action, date, description, notes, user_id)
from '%(directory)s/data/demodata/bill_changes.csv'
csv ; 


COPY public.motion_changes (change_id, content_id, action, date, description, notes, user_id) 
from '%(directory)s/data/demodata/motion_changes.csv'
csv ; 

COPY public.question_versions
FROM '%(directory)s/data/demodata/question_versions.csv'
CSV; 

COPY public.motion_versions
FROM '%(directory)s/data/demodata/motion_versions.csv'
CSV; 

COPY public.bill_versions
FROM '%(directory)s/data/demodata/bill_versions.csv'
CSV; 

UPDATE public.parliamentary_items 
    SET status='admissible'  
    WHERE type = 'question' 
    AND status = 'draft';

*/

SELECT setval('motion_changes_change_id_seq', 4000);

SELECT setval('bill_changes_change_id_seq', 4000);

SELECT setval('question_changes_change_id_seq', 4000);

SELECT setval('item_sequence', 4000);

SELECT setval('bill_versions_version_id_seq', 2000);
SELECT setval('question_versions_version_id_seq', 2000);
SELECT setval('motion_versions_version_id_seq', 2000);
 
insert into zope_principal_role_map
select users.login, 'bungeni.owner' as role_id, true as setting, parliamentary_items.type, parliamentary_items.parliamentary_item_id 
from users inner join parliamentary_items on users.user_id = parliamentary_items.owner_id;

insert into zope_role_permission_map
select 'bungeni.Owner' as role_id,
 'bungeni.' || parliamentary_items.type ||  '.Edit' as permission_id,
true as setting,
parliamentary_items.type as type,
parliamentary_items.parliamentary_item_id as object_id
from parliamentary_items;

insert into zope_role_permission_map
select 'bungeni.Owner' as role_id,
 'zope.View' as permission_id,
true as setting,
parliamentary_items.type as type,
parliamentary_items.parliamentary_item_id as object_id
from parliamentary_items;

insert into zope_role_permission_map
select 'bungeni.Anybody' as role_id,
 'zope.View' as permission_id,
false as setting,
parliamentary_items.type as type,
parliamentary_items.parliamentary_item_id as object_id
from parliamentary_items;


insert into zope_role_permission_map
select 'bungeni.Everybody' as role_id,
 'zope.View' as permission_id,
false as setting,
parliamentary_items.type as type,
parliamentary_items.parliamentary_item_id as object_id
from parliamentary_items;





