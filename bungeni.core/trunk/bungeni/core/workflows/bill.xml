<?xml version="1.0"?>
<workflow
   id="bill-workflow"
   title="bill Workflow"
   description="A bill"
   initial_state="">

  <state id="billstates.draft" title="draft bill">
    <grant permission="bungeni.bill.Edit" role="bungeni.Owner" />
    <grant permission="bungeni.bill.View" role="bungeni.Owner" />    
    <grant permission="bungeni.bill.Delete" role="bungeni.Owner" />    
  </state>
  
  <state id="billstates.submitted" title="bill published in gazette">
    <deny permission="bungeni.bill.Edit" role="bungeni.Owner" />
    <deny permission="bungeni.bill.Delete" role="bungeni.Owner" />        
    <grant permission="bungeni.bill.View" role="bungeni.Clerk" />   
    <grant permission="bungeni.bill.Edit" role="bungeni.Clerk" />    
    <grant permission="bungeni.bill.View" role="bungeni.Everybody" /> 
  </state>

  <state id="billstates.first_reading" title="first reading">

  </state>
  

  <state id="billstates.first_reading_postponed" title="first reading postponed">
    
  </state>
  

  <!--state id="billstates.second_reading_pending" title="second reading pending">

      </state-->
  

  <state id="billstates.second_reading" title="second reading">
    
  </state>
  

  <state id="billstates.second_reading_postponed" title="second reading postponed">
    
  </state>
  

  <!--state id="billstates.house_pending" title="house pending">
      
      </state-->
  

  <state id="billstates.whole_house" title="whole house">

  </state>
  

  <state id="billstates.whole_house_postponed" title="whole house postponed">

  </state>
  

  <state id="billstates.second_committee" title="second committee">
    
  </state>
  

  <!--state id="billstates.report_reading_pending" title="report reading pending">
      
      </state-->
  

  <state id="billstates.report_reading" title="report reading">
    
  </state>
  

  <state id="billstates.report_reading_postponed" title="report reading postponed">
    
  </state>
  

  <!--state id="billstates.third_reading_pending" title="third reading pending">
      
      </state-->
  

  <state id="billstates.third_reading" title="third reading">
    
  </state>
  

  <state id="billstates.third_reading_postponed" title="third reading postponed">

  </state>
  

  <state id="billstates.withdrawn" title="bill withdrawn">
    <deny permission="bungeni.bill.Edit" role="bungeni.Clerk" />
  </state>
  

  <state id="billstates.approved" title="approved bill">
    <deny permission="bungeni.bill.Edit" role="bungeni.Clerk" />
  </state>
  

  <state id="billstates.rejected" title="rejected bill">
    <deny permission="bungeni.bill.Edit" role="bungeni.Clerk" />
  </state>
  

  
  <transition
     id="create-bill"
     title="Create"
     trigger="automatic"
     source=""
     destination="billstates.draft"
     action="bungeni.core.workflows.bill.actions.create"
     condition=""
     />
  <transition
     id="submit-bill"
     title="Publish in Gazette"
     trigger="manual"
     source="billstates.draft"
     destination="billstates.submitted"
     permission="bungeni.bill.Submit"
     action="bungeni.core.workflows.bill.actions.submit"
     condition=""
     />
  <transition
     id="schedule-first"
     title="Schedule First Reading"
     trigger="manual"
     source="billstates.submitted"
     destination="billstates.first_reading"
     permission="bungeni.bill.Schedule"
     action="bungeni.core.workflows.bill.actions.schedule_first"
     condition="bungeni.core.workflows.utils.getBillSchedule"
     />
  <transition
     id="postpone-first"
     title="Postpone First Reading"
     trigger="manual"
     source="billstates.first_reading"
     destination="billstates.first_reading_postponed"
     permission="bungeni.bill.Schedule"
     action="bungeni.core.workflows.bill.actions.postpone_first"
     condition=""
     />
  <transition
     id="reschedule-first"
     title="Reschedule First Reading"
     trigger="manual"
     source="billstates.first_reading_postponed"
     destination="billstates.first_reading"
     permission="bungeni.bill.Schedule"
     action="bungeni.core.workflows.bill.actions.schedule_first"
     condition=""
     />
  <transition
     id="select-first-committee"
     title="Send to Committee"
     trigger="manual"
     source="billstates.first_reading"
     destination="billstates.first_committee"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />

  <transition
     id="resend-first-reading-from-committee"
     title="Back to first reading"
     trigger="manual"
     source="billstates.first_committee"
     destination="billstates.first_reading"
     permission="bungeni.bill.RevertTransitions"
     action=""
     condition=""
     />

  <transition
     id="schedule-second-from-first-committee"
     title="Second Reading schedule"
     trigger="manual"
     source="billstates.first_committee"
     destination="billstates.second_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <!--transition
      id="schedule-second"
      title="Schedule Second Reading"
      trigger="manual"
      source="billstates.second_reading_pending"
      destination="billstates.second_reading"
      permission="bungeni.bill.Schedule"
      action=""
      condition=""
      /-->
  <transition
     id="schedule-second"
     title="Schedule Second Reading"
     trigger="manual"
     source="billstates.first_reading"
     destination="billstates.second_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />

  <transition
     id="resend-first-schedule-second"
     title="Schedule Second Reading"
     trigger="manual"
     source="billstates.second_reading"
     destination="billstates.first_reading"
     permission="bungeni.bill.RevertTransitions"
     action=""
     condition=""
     />


  <transition
     id="postpone-second"
     title="Postpone Second Reading"
     trigger="manual"
     source="billstates.second_reading"
     destination="billstates.second_reading_postponed"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="reschedule-second"
     title="Reschedule Second Reading"
     trigger="manual"
     source="billstates.second_reading_postponed"
     destination="billstates.second_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="schedule-whole-house"
     title="Schedule Whole House Committee"
     trigger="manual"
     source="billstates.second_reading"
     destination="billstates.whole_house"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />

  <transition
     id="resend-second-reading-from-whole-house"
     title="Resend Second Reading"
     trigger="manual"
     source="billstates.whole_house"
     destination="billstates.second_reading"
     permission="bungeni.bill.RevertTransitions"
     action=""
     condition=""
     />

  <!--transition
      id="schedule-whole-house"
      title="Do Schedule Whole House Committee"
      trigger="manual"
      source="billstates.house_pending"
      destination="billstates.whole_house"
      permission="bungeni.bill.Schedule"
      action=""
      condition=""
      /-->
  <transition
     id="postpone-whole-house"
     title="Postpone Whole House Committee"
     trigger="manual"
     source="billstates.whole_house"
     destination="billstates.whole_house_postponed"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="reschedule-whole-house"
     title="Reschedule Whole House Committee"
     trigger="manual"
     source="billstates.whole_house_postponed"
     destination="billstates.whole_house"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="postpone-second-reading-and-whole-house"
     title="Postpone Second Reading and Whole House Committee"
     trigger="manual"
     source="billstates.whole_house"
     destination="billstates.second_reading_postponed"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="select-second-committee"
     title="Send to Committee"
     trigger="manual"
     source="billstates.whole_house"
     destination="billstates.second_committee"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />

  <transition
     id="resend-whole-house-from-second-committee"
     title="Resend to whole house"
     trigger="manual"
     source="billstates.second_committee"
     destination="billstates.whole_house"
     permission="bungeni.bill.RevertTransitions"
     action=""
     condition=""
     />

  <transition
     id="schedule-second-report-reading"
     title="Schedule Report Reading"
     trigger="manual"
     source="billstates.second_committee"
     destination="billstates.report_reading"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />
  <!--transition
      id="schedule-second-report-reading"
      title="Schedule Report Reading"
      trigger="manual"
      source="billstates.report_reading_pending"
      destination="billstates.report_reading"
      permission="bungeni.bill.SelectCommittee"
      action=""
      condition=""
      /-->
  <transition
     id="postpone-second-report-reading"
     title="Postpone Report Reading"
     trigger="manual"
     source="billstates.report_reading"
     destination="billstates.report_reading_postponed"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />
  <transition
     id="reschedule-second-report-reading"
     title="Reschedule Report Reading"
     trigger="manual"
     source="billstates.report_reading_postponed"
     destination="billstates.report_reading"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />
  <transition
     id="second-committee-schedule-third-reading"
     title="Schedule Third Reading"
     trigger="manual"
     source="billstates.report_reading"
     destination="billstates.third_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <!--transition
      id="second-committee-schedule-third-reading"
      title="Schedule Third Reading"
      trigger="manual"
      source="billstates.third_reading_pending"
      destination="billstates.third_reading"
      permission="bungeni.bill.Schedule"
      action=""
      condition=""
      /-->
  <transition
     id="recommit-second-committee"
     title="Recommit to 2nd Committee"
     trigger="manual"
     source="billstates.report_reading"
     destination="billstates.second_committee"
     permission="bungeni.bill.SelectCommittee"
     action=""
     condition=""
     />
  <transition
     id="schedule-third-reading"
     title="Schedule Third Reading"
     trigger="manual"
     source="billstates.whole_house"
     destination="billstates.third_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />

  <transition
     id="resend-whole-house-from-third-reading"
     title="Resend to whole house"
     trigger="manual"
     source="billstates.third_reading"
     destination="billstates.whole_house"
     permission="bungeni.bill.RevertTransitions"
     action=""
     condition=""
     />

  <transition
     id="postpone-third-reading"
     title="Postpone Third Reading"
     trigger="manual"
     source="billstates.third_reading"
     destination="billstates.third_reading_postponed"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />
  <transition
     id="reschedule-third-reading"
     title="Postpone Third Reading"
     trigger="manual"
     source="billstates.third_reading_postponed"
     destination="billstates.third_reading"
     permission="bungeni.bill.Schedule"
     action=""
     condition=""
     />

  <transition
     id="reject"
     title="Rejected"
     trigger="manual"
     source="billstates.third_reading"
     destination="billstates.rejected"
     permission="bungeni.bill.ChangeStatus"
     action=""
     condition=""
     />
  <transition
     id="approve"
     title="Approved"
     trigger="manual"
     source="billstates.third_reading"
     destination="billstates.approved"
     permission="bungeni.bill.ChangeStatus"
     action=""
     condition=""
     />
  
  <transition
     id="withdraw-submitted"
     title="Withdraw"
     trigger="manual"
     source="billstates.submitted
             billstates.first_reading
             billstates.first_committee
             billstates.second_reading
             billstates.whole_house
             billstates.second_committee
             billstates.report_reading
             billstates.third_reading
             billstates.withdrawn"
     destination="billstates.withdrawn"
     permission="bungeni.bill.Withdraw"
     action="bungeni.core.workflows.bill.actions.withdraw"
     condition=""
     />

</workflow>

